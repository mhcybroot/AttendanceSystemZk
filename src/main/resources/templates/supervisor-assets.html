<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Asset Inventory (Read-Only)</title>
</head>

<body>
    <div th:replace="~{layout :: layout(~{::section}, ~{::script}, 'supervisor-assets')}">
        <section>
            <div
                class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                <h1 class="h2">Company Asset Inventory</h1>
                <span class="badge bg-secondary">Read-Only View</span>
            </div>

            <!-- Stats Cards -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <a href="/supervisor/assets" class="text-decoration-none">
                        <div class="card text-white bg-primary mb-3 shadow-sm h-100 card-hover">
                            <div class="card-body">
                                <h5 class="card-title">Total Assets</h5>
                                <h2 class="card-text" th:text="${stats.total}">0</h2>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-md-3">
                    <a href="/supervisor/assets?status=AVAILABLE" class="text-decoration-none">
                        <div class="card text-white bg-success mb-3 shadow-sm h-100 card-hover">
                            <div class="card-body">
                                <h5 class="card-title">Available</h5>
                                <h2 class="card-text" th:text="${stats.available}">0</h2>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-md-3">
                    <a href="/supervisor/assets?status=ASSIGNED" class="text-decoration-none">
                        <div class="card text-white bg-warning mb-3 shadow-sm h-100 card-hover">
                            <div class="card-body">
                                <h5 class="card-title">Assigned</h5>
                                <h2 class="card-text" th:text="${stats.assigned}">0</h2>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-md-3">
                    <a href="/supervisor/assets?status=UNAVAILABLE" class="text-decoration-none">
                        <div class="card text-white bg-danger mb-3 shadow-sm h-100 card-hover">
                            <div class="card-body">
                                <h5 class="card-title">Unavailable / Other</h5>
                                <h2 class="card-text" th:text="${stats.broken}">0</h2>
                            </div>
                        </div>
                    </a>
                </div>
            </div>

            <style>
                .card-hover:hover {
                    transform: translateY(-3px);
                    transition: transform 0.2s ease;
                    opacity: 0.9;
                    cursor: pointer;
                }
            </style>

            <!-- Inventory Table -->
            <div class="card shadow-sm">
                <div class="card-header bg-white">
                    <div class="input-group">
                        <span class="input-group-text bg-light"><i class="fas fa-search"></i></span>
                        <input type="text" id="assetSearch" class="form-control"
                            placeholder="Quick Filter by Name, Tag, or Employee...">
                    </div>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover mb-0 align-middle" id="assetTable">
                            <thead class="table-light">
                                <tr>
                                    <th>Asset Tag</th>
                                    <th>Name</th>
                                    <th>Category</th>
                                    <th>Status</th>
                                    <th>Assigned To</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr th:each="asset : ${assets}">
                                    <td class="fw-bold" th:text="${asset.assetTag}">TAG-001</td>
                                    <td th:text="${asset.name}">Dell Latitude</td>
                                    <td><span class="badge bg-secondary" th:text="${asset.category}">LAPTOP</span></td>
                                    <td>
                                        <span class="badge"
                                            th:classappend="${asset.status.name() == 'AVAILABLE' ? 'bg-success' : (asset.status.name() == 'ASSIGNED' ? 'bg-warning text-dark' : 'bg-danger')}"
                                            th:text="${asset.status}">AVAILABLE</span>
                                    </td>
                                    <td>
                                        <div th:if="${asset.assignedTo != null}">
                                            <i class="fas fa-user text-muted small me-1"></i> <span
                                                th:text="${asset.assignedTo.name}">John Doe</span>
                                            <small class="text-muted d-block"
                                                th:if="${asset.assignedTo.department != null}"
                                                th:text="${asset.assignedTo.department.name}">IT</small>
                                        </div>
                                        <div th:if="${asset.assignedTo == null}" class="text-muted small">
                                            -
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <script>
                // Simple client-side search for supervisors
                document.getElementById('assetSearch').addEventListener('keyup', function () {
                    let value = this.value.toLowerCase();
                    let rows = document.querySelectorAll('#assetTable tbody tr');

                    rows.forEach(row => {
                        let text = row.textContent.toLowerCase();
                        row.style.display = text.includes(value) ? '' : 'none';
                    });
                });
            </script>
        </section>
    </div>
</body>

</html>