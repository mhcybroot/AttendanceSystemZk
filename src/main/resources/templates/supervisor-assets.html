<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Asset Inventory (Read-Only)</title>
</head>

<body>
    <div th:replace="~{layout :: layout(~{::section}, ~{::script}, 'supervisor-assets')}">
        <section>
            <div
                class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                <h1 class="h2">Company Asset Inventory</h1>
                <span class="badge bg-secondary">Read-Only View</span>
            </div>

            <!-- Stats Cards (Modern Corporate Style) -->
            <div class="row mb-4 g-3">
                <div class="col-md-3">
                    <a href="/supervisor/assets" class="text-decoration-none">
                        <div class="card h-100 border-start border-4 border-primary card-hover p-2">
                            <div class="card-body d-flex align-items-center justify-content-between">
                                <div>
                                    <h6 class="text-uppercase text-muted small fw-bold mb-1">Total Assets</h6>
                                    <h2 class="mb-0 fw-bold text-dark" th:text="${stats.total}">0</h2>
                                </div>
                                <div class="bg-primary bg-opacity-10 p-3 rounded-circle text-primary">
                                    <i class="fas fa-cubes fa-lg"></i>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-md-3">
                    <a href="/supervisor/assets?status=AVAILABLE" class="text-decoration-none">
                        <div class="card h-100 border-start border-4 border-success card-hover p-2">
                            <div class="card-body d-flex align-items-center justify-content-between">
                                <div>
                                    <h6 class="text-uppercase text-muted small fw-bold mb-1">Available</h6>
                                    <h2 class="mb-0 fw-bold text-dark" th:text="${stats.available}">0</h2>
                                </div>
                                <div class="bg-success bg-opacity-10 p-3 rounded-circle text-success">
                                    <i class="fas fa-check-circle fa-lg"></i>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-md-3">
                    <a href="/supervisor/assets?status=ASSIGNED" class="text-decoration-none">
                        <div class="card h-100 border-start border-4 border-warning card-hover p-2">
                            <div class="card-body d-flex align-items-center justify-content-between">
                                <div>
                                    <h6 class="text-uppercase text-muted small fw-bold mb-1">Assigned</h6>
                                    <h2 class="mb-0 fw-bold text-dark" th:text="${stats.assigned}">0</h2>
                                </div>
                                <div class="bg-warning bg-opacity-10 p-3 rounded-circle text-warning">
                                    <i class="fas fa-user-tag fa-lg"></i>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-md-3">
                    <a href="/supervisor/assets?status=UNAVAILABLE" class="text-decoration-none">
                        <div class="card h-100 border-start border-4 border-danger card-hover p-2">
                            <div class="card-body d-flex align-items-center justify-content-between">
                                <div>
                                    <h6 class="text-uppercase text-muted small fw-bold mb-1">Unavailable</h6>
                                    <h2 class="mb-0 fw-bold text-dark" th:text="${stats.broken}">0</h2>
                                </div>
                                <div class="bg-danger bg-opacity-10 p-3 rounded-circle text-danger">
                                    <i class="fas fa-exclamation-triangle fa-lg"></i>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            </div>

            <style>
                .card-hover:hover {
                    transform: translateY(-3px);
                    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05) !important;
                    cursor: pointer;
                }

                .status-badge {
                    padding: 0.5em 1em;
                    font-size: 0.75rem;
                    letter-spacing: 0.05em;
                    text-transform: uppercase;
                }
            </style>

            <!-- Inventory Table -->
            <div class="card border-0 mb-5">
                <div class="card-header bg-white py-3 border-0">
                    <div class="input-group shadow-sm">
                        <span class="input-group-text bg-white border-end-0 text-muted"><i
                                class="fas fa-search"></i></span>
                        <input type="text" id="assetSearch" class="form-control border-start-0 ps-0"
                            placeholder="Quick Filter by Name, Tag, or Employee...">
                    </div>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-hover mb-0 align-middle" id="assetTable"
                            style="border-collapse: separate; border-spacing: 0;">
                            <thead class="table-light">
                                <tr>
                                    <th class="ps-4 py-3">Asset Tag</th>
                                    <th>Name</th>
                                    <th>Category</th>
                                    <th>Status</th>
                                    <th>Assigned To</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr th:each="asset : ${assets}" class="border-bottom">
                                    <td class="ps-4 fw-bold text-primary" th:text="${asset.assetTag}">TAG-001</td>
                                    <td class="fw-medium text-dark" th:text="${asset.name}">Dell Latitude</td>
                                    <td>
                                        <span
                                            class="badge bg-secondary bg-opacity-25 text-secondary border border-secondary border-opacity-25 fw-normal"
                                            th:text="${asset.category}">LAPTOP</span>
                                    </td>
                                    <td>
                                        <span class="badge status-badge" th:classappend="${asset.status.name() == 'AVAILABLE' ? 'bg-success bg-opacity-25 text-success' : 
                                                             (asset.status.name() == 'ASSIGNED' ? 'bg-warning bg-opacity-25 text-warning' : 
                                                             'bg-danger bg-opacity-25 text-danger')}"
                                            th:text="${asset.status}">AVAILABLE</span>
                                    </td>
                                    <td>
                                        <div th:if="${asset.assignedTo != null}" class="d-flex align-items-center">
                                            <div class="bg-primary bg-opacity-10 rounded-circle p-2 me-2 text-primary">
                                                <i class="fas fa-user small"></i>
                                            </div>
                                            <div>
                                                <div class="fw-bold text-dark small" th:text="${asset.assignedTo.name}">
                                                    John Doe</div>
                                                <small class="text-muted d-block"
                                                    th:if="${asset.assignedTo.department != null}"
                                                    th:text="${asset.assignedTo.department.name}">IT</small>
                                            </div>
                                        </div>
                                        <div th:if="${asset.assignedTo == null}" class="text-muted small ms-2">
                                            <span class="badge bg-light text-secondary">Unassigned</span>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <script>
                // Simple client-side search for supervisors
                document.getElementById('assetSearch').addEventListener('keyup', function () {
                    let value = this.value.toLowerCase();
                    let rows = document.querySelectorAll('#assetTable tbody tr');

                    rows.forEach(row => {
                        let text = row.textContent.toLowerCase();
                        row.style.display = text.includes(value) ? '' : 'none';
                    });
                });
            </script>
        </section>
    </div>
</body>

</html>